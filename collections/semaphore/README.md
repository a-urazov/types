# Семафор

Пакет `semaphore` предоставляет простую реализацию семафора для управления доступом к общему ресурсу с ограниченной пропускной способностью.

## Что такое семафор?

Семафор — это примитив синхронизации, который ограничивает количество горутин, которые могут одновременно получить доступ к ресурсу. Это полезно для контроля параллелизма, например, для ограничения количества одновременных HTTP-запросов или операций с базой данных.

## Установка

Этот пакет является частью библиотеки `types`. Чтобы использовать его, импортируйте соответствующий пакет:

```go
import "types/collections/semaphore"
```

## Пример использования

Вот пример, демонстрирующий, как использовать семафор для ограничения доступа к ресурсу до 2 одновременных горутин:

```go
package main

import (
	"context"
	"fmt"
	"sync"
	"time"

	"types/collections/semaphore"
)

func main() {
	// Создаем семафор с пропускной способностью 2
	s := semaphore.New(2)
	var wg sync.WaitGroup

	// Запускаем 5 горутин, которые пытаются получить доступ к ресурсу
	for i := 0; i < 5; i++ {
		wg.Add(1)
		go func(id int) {
			defer wg.Done()

			fmt.Printf("Горутина %d: пытается получить семафор...\n", id)
			// Пытаемся захватить семафор
			err := s.Acquire(context.Background())
			if err != nil {
				fmt.Printf("Горутина %d: не удалось получить семафор: %v\n", id, err)
				return
			}

			fmt.Printf("Горутина %d: получила семафор, выполняет работу...\n", id)
			time.Sleep(1 * time.Second) // Имитация работы

			// Освобождаем семафор
			s.Release()
			fmt.Printf("Горутина %d: освободила семафор.\n", id)
		}(i)
	}

	wg.Wait()
}
```

## API

### `New(capacity int) *Semaphore`

Создает и возвращает новый экземпляр `Semaphore` с указанной `capacity` (пропускной способностью).

### `Acquire(ctx context.Context) error`

Захватывает один "билет" из семафора. Если семафор уже заполнен (все билеты розданы), вызов блокируется до тех пор, пока другой горутин не освободит билет с помощью `Release()`.

Этот метод учитывает `context.Context`. Если контекст будет отменен до того, как удалось захватить семафор, метод вернет ошибку контекста.

### `Release()`

Освобождает один "билет", возвращая его в семафор. Это позволяет другой заблокированной горутине (если таковая имеется) захватить его.

